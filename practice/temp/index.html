<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
  </head>
  <body>
    <h1>Hello World!</h1>
    We are using Node.js <span id="node-version"></span>,
    Chromium <span id="chrome-version"></span>,
    and Electron <span id="electron-version"></span>.

    <!-- You can also require other files to run in this process -->
    <script src="./renderer.js"></script>

    <h id="test"> test</h>
    <video id="player" controls autoplay></video>
    <button id="capture">Capture</button>
    <button id="save">Save</button>
    <canvas id="snapshot" width=1920 height=1080></canvas>
    <img id="result" width=1920 height=1080></img>
    <script>
      var player = document.getElementById('player');
      var snapshotCanvas = document.getElementById('snapshot');
      var captureButton = document.getElementById('capture');
      var saveButton = document.getElementById('save');

      var handleSuccess = function(stream) {
        // Attach the video stream to the video element and autoplay.
        player.srcObject = stream;
      };

      captureButton.addEventListener('click', function() {
          var context = snapshot.getContext('2d');
          // Draw the video frame to the canvas.
          context.drawImage(player, 0, 0, snapshotCanvas.width,
               snapshotCanvas.height);
      });

      saveButton.addEventListener('click', function() {
          //saveATag= document.getElementById('save')
          //saveATag.href = snapshotCanvas.toDataURL("image/png");
          //saveATag.download = 'jskim8.png'
          console.log('test');
          const axios = require('axios');
          axios.post('http://127.0.0.1:9000',{
            fileName:'jskim8.png',
            img: snapshotCanvas.toDataURL("image/png")
          })
          .then(function(response){
            document.getElementById('result').src = response.data;
          })
          .catch(function(error){
            console.log(error);
          });
      });

      navigator.mediaDevices.getUserMedia({video: true}).then(handleSuccess);
</script>

  </body>
</html>
